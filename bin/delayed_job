#!/usr/bin/env ruby
require File.expand_path(File.join(File.dirname(__FILE__), '..', 'config', 'environment'))
require 'delayed/command'
require 'securerandom'

# this stops workers running other docker containers from picking up the same job,
# however jobs left locked on SIGKILL will be ignored for 4 hours
uuid_prefix = '--prefix=' + SecureRandom.uuid

queues = [
  '--pool=uh_sync_cases:1', # worker dedicated for sync
  '--pool=message_jobs:1'
]

params = [uuid_prefix] + queues + ARGV
puts params
Delayed::Command.new(params).daemonize
